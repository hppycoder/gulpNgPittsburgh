<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Building without boundries with Gulp</title>

    <meta name="description"
          content="A presentation that was presented to ngPittsburgh in Pittsburgh, PA. This presentation explores how to use Gulp for all your build processes.">
    <meta name="author" content="Chad Smith">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css" id="theme">
    <link rel="stylesheet" href="css/theme/giftcards.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<header>
    <div style="text-align:center;">
        <img class="logo" src="images/logoGiftCards.png" alt="GiftCards Logo">
    </div>
    <div class="smiling-g">
        <img src="images/smallG.png" alt="GiftCards Logo" style="height:30px; width:30px;">
    </div>
</header>
<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
        <section>
            <h1>Building without boundaries</h1>

            <h3>A presentation about Gulp</h3>

            <p>
                <small>Created by: Chad Smith</small>
            </p>
        </section>

        <section>
            <h2>Who am I?</h2>

            <p>Chad Smith (@hppycoder)<br />Software Development Manager for GiftCards.com</p>
            <aside class="notes">
                <strong>Pleased to meet everyone!</strong>
                <ul>
                    <li>My name is Chad Smith, and I am the software development manager for the front end group at
                        GiftCards.com!
                    </li>
                    <li>We developed an application that allows users to upload their photos and have them be printed
                        onto a Giftcard. Yes, even you could have your face be on a VISA gift card.
                    </li>
                    <li>The talk today will center around how my team and I reshaped our Flash application and used
                        HTML5 to do all the work.
                    </li>
                </ul>
            </aside>
        </section>

        <section>
            <h2>What is Gulp?</h2>
            <ul>
                <li>Built with Node</li>
                <li>Processes in memory instead of the filesystem</li>
                <li>Runs asynchronously</li>
                <li>Uses a Vinyl architecture</li>
            </ul>

            <aside class="notes">Gulp is a Node based build system built on extensibility and efficiency. It has hundreds of downloads an hour on the NPM network and most of what you have done with Grunt can be converted to Gulp.</aside>
        </section>

        <section>
            <section>
                <h2>Getting Started</h2>
                <p>Install Gulp globally</p>
                <pre><code data-trim contenteditable>
$ npm install -g gulp
                </code></pre>
            </section>
            <section>
                <h3>Include in package.json</h3>
                <pre><code>
{
  "name": "giftcards-gulp",
  "version": "0.0.0",
  "dependencies": {
    "gulp": "^3.8.10",
    "gulp-bower": "~0.0.6"
  },
  "engines": {
    "node": ">=0.10.0"
  }
}
                </code></pre>
            </section>
            <section>
                <h2>Sample gulpfile.js</h2>
                <pre><code>
'use strict';

var gulp = require('gulp');
var appDestPath = './cart/bower_components';
gulp.task('bower', function () {
  return bower().pipe(gulp.dest(appDestPath));
});
gulp.task('dev', ['bower']);
                </code></pre>
            </section>
        </section>

        <section>
            <h2>Plan Ahead</h2>
            <ul>
                <li>List what you want automated</li>
                <li>Find modules to help with automation</li>
                <li>What is considered a &quot;Failed&quot; build</li>
                <li>Start making your Gulpfile</li>
                <li>Train team (if applicable) on changes</li>
                <li>Link into Deployment process</li>
            </ul>
        </section>

        <section>
            <section>
                <h2>Common terminology</h2>
                <p>Review common functions used in Gulp which is the foundation to all Gulp files</p>
            </section>
            <section>
                <h2 style="text-transform: lowercase;">gulp.src</h2>
                <ul>
                    <li>Emits files that match glob patterns</li>
                    <li>Returns a stream of Vinyl files</li>
                    <li>Can include or exclude files with patterns</li>
                    <li>Glob patterns run in order defined</li>
                </ul>
                <pre><code>
gulp.src([
  distPath + '/scripts/**', distPath2+'/**',
  './htdocs/+(app|fonts|js|css)/**',
  '!./htdocs/js/yui/**'
], {read: false})
                </code></pre>
            </section>
            <section>
                <h2 style="text-transform: lowercase;">gulp.dest</h2>
                <ul>
                    <li>Writes files to the relative path file system</li>
                    <li>Emits the same stream that was sent into it</li>
                    <li>Relative paths are calculated against base</li>
                </ul>
            </section>
            <section>
                <h2 style="text-transform: lowercase;">pipe</h2>
                <ul>
                    <li>Pulls data out of the readable stream</li>
                    <li>Writes data to supplied destination</li>
                    <li>Manages data flow for fast moving streams</li>
                </ul>
            </section>
            <section>
                <h2>Tasks</h2>
                <ul>
                    <li>Specifies a friendly name to functionality</li>
                    <li>Cannot contain spaces</li>
                    <li>Returns when completed</li>
                    <li>Can be used as a dependency for other tasks</li>
                </ul>
                <pre><code>
gulp.task('bower', function () {
  return bower().pipe(gulp.dest('./bower_components'));
});
gulp.task('dev', ['bower']);
                    </code></pre>
            </section>
            <section>
                <h2>Dependencies</h2>

                <pre><code>
var gulp = require('gulp');
var clean = require('gulp-clean');
var bower = require('gulp-bower');

gulp.task('cleanDist', function() {
  return gulp.src('./dist/**').pipe(clean());
});
gulp.task('bower', function ('cleanDist') {
  return bower().pipe(gulp.dest('./bower_components'));
});
gulp.task('dev', ['bower']);
                </code></pre>
            </section>
            <section>
                <h2>Vinyl Streams and Adapters</h2>
                <ul>
                    <li>Stream is a collection of vinyl objects</li>
                    <li>Vinyl is the metadata behind the file</li>
                    <li>Vinyl Adapters are readers of the files that follow the interface src, dest, and watch</li>
                </ul>
            </section>
            <section>
                <h2>Plugins</h2>
                <p>Manipulate and returns vinyl streams with modified data</p>

                <pre><code>
var gulp = require('gulp'),
    ngAnnotate = require('gulp-ng-annotate'),
    uglify = require('gulp-uglify');

gulp.task('annotateCardBuild', ['buildAssets'], function() {
  return gulp.src(cardBuildDistPath + '/cardBuild/buildApp.js')
    .pipe(ngAnnotate())
    .pipe(uglify())
    .pipe(gulp.dest(cardBuildDistPath + '/cardBuild'));
});
                </code></pre>
            </section>

        </section>

        <section>
            <h2>SASS</h2>
            <p>You can generate all your CSS with SASS/Compass.</p>
            <pre><code>
var plumber = require('gulp-plumber'),
    compass = require('gulp-compass');

gulp.task('compass', function () {
  return gulp.src('./sass/*.scss')
    .pipe(plumber())
    .pipe(compass({
      css: 'dist/css',
      sass: 'sass'
    }))
    .pipe(gulp.dest('dist/css'));
});
            </code></pre>
        </section>
        <section>
            <h2>Bower</h2>
            <p>Runs `bower install` with provided arguments and options. Returns Vinyl Stream with created files.</p>
            <pre><code>
var bower = require('gulp-bower');
gulp.task('bower', function () {
  return bower().pipe(gulp.dest('./bower_components'));
});
            </code></pre>
        </section>
        <section>
            <h2>UglifyJS</h2>
            <p>Takes a Vinyl Stream of JS files and runs through UglifyJS's native code with provided options.</p>
            <pre><code>
var uglify = require('gulp-uglify');
gulp.task('minifyCardBuildAssets', ['annotateBuild'], function() {
  return gulp.src(distPath + '/**/*.js')
    .pipe(uglify())
    .pipe(gulp.dest(distPath));
});
            </code></pre>
        </section>
        <section>
            <section>
                <h2>Arguments</h2>
                <p>Allows Gulp to take in arguments which can be used in the build process. Useful for passing in versions for instance.</p>
                <pre><code>
gulp build --ver=2.9.24-rc.5
                </code></pre>
            </section>
            <section>
                <h2>Arguments Example</h2>
                <pre><code>
var argv = require('yargs').argv;
if (argv.ver) {
  if (argv.ver.indexOf('-') > -1) {
    version = argv.ver.slice(0, argv.ver.indexOf('-'));
  } else {
    version = (argv.ver);
  }
} else {
  version = '0.0.0';
}
                </code></pre>
            </section>
        </section>
        <section>
            <h2>Merge</h2>
            <p>Merges multiple process streams together and will finalize task when all streams are complete.</p>
            <pre><code>
var merge = require('merge-stream');
gulp.task('bower', function () {
  return merge(
    gulp.src('./htdocs/js-app/**').pipe(gulp.dest('./dist/js-app')),
    gulp.src('./htdocs/cart/**').pipe(gulp.dest('./dist/cart'))
  );
});
            </code></pre>
        </section>
        <section>
            <h2 style="text-transform: none;">ngAnnotate</h2>
            <p>This plugin will rewrite the AngularJS compiler passes to allow for concatenation and minifcation. Otherwise the DI container would be broken due to minified code.</p>
            <p><strong>Formerly named: ngmin</strong></p>
            <pre><code>
var ngAnnotate = require('gulp-ng-annotate');
gulp.task('annotateCardBuild', ['buildCardBuildAssets'], function() {
return gulp.src(cardBuildDistPath + '/cardBuild/buildApp.js')
  .pipe(ngAnnotate())
  .pipe(uglify())
  .pipe(gulp.dest(cardBuildDistPath + '/cardBuild'));
});
            </code></pre>
        </section>
        <section>
            <h2>Protractor</h2>
            <p>Have all your Protractor tests run with Gulp and provide feedback for failed builds.</p>
            <pre><code>
var cardBuildSrcPath = './src/AppBundle/Resources/js-app/cardbuild';
gulp.task('cardBuildE2ETests', function() {
  var protractor = require('gulp-protractor').protractor;
  gulp.src([cardBuildBasePath + '/test/e2e/*.js'])
    .pipe(protractor({
      configFile: cardBuildSrcPath+'/protractor.conf.js',
      args: ['--baseUrl', 'http://www.giftcards.com']
    }))
    .on('error', function(e) { throw e; });
});
            </code></pre>
        </section>
        <section>
            <h2>Unit Tests</h2>
            <p>Modules: <em>karma</em>, <em>karma-jasmine</em>, <em>karma-phantomjs-launcher</em>, <em>karma-ng-html2js-preprocessor</em></p>
            <pre><code>
gulp.task('cardBuildUnitTests', ['bower'], function(done) {
  var karma = require('karma').server;
  karma.start({
    configFile: cardBuildBasePath + '/karma.conf.js',
    singleRun: false
  }, function(exitStatus){
    done(exitStatus ? 'Failing Unit Tests!' : undefined);
  });
});
            </code></pre>
        </section>
        <section>
            <h2>Minify CSS</h2>
            <p>Thin wrapper to clean-css which optimizes CSS files</p>
            <pre><code>
var minifyCSS = require('gulp-minify-css');
gulp.task('minifyCSS', ['cardBuildLess'], function () {
  return gulp.src('./htdocs/css/**/*.css')
    .pipe(minifyCSS())
    .pipe(gulp.dest('./htdocs/css'));
});
            </code></pre>
        </section>

        <section>
            <h2>Downside to Gulp</h2>
            <ul>
                <li>Slower builds</li>
                <li>Multiple NPMs don't cascade</li>
                <li>Relying on other plugins</li>
                <li>Language changes</li>
                <li>Awful error handling</li>
                <li>One build to rule them all</li>
            </ul>
        </section>

        <section>
            <section>
                <h2>Gulp not for you?</h2>
                <p>Alternatives to using Gulp</p>
                <ul>
                    <li>Make (Make)</li>
                    <li>Grunt (Node)</li>
                    <li>Broccoli (Node)</li>
                    <li>Brunch (Node)</li>
                    <li>Jake (Node)</li>
                    <li>Rake (Ruby)</li>
                    <li>NPM (Node)</li>
                </ul>
            </section>
            <section>
                <h2>Pure NPM</h2>
                <pre><code>
"devDependencies": {
  "jshint": "latest",
},
"scripts": {
  "lint": "jshint **.js"
}
                </code></pre>
            </section>
        </section>
        <section>
            <h2>Conclusion</h2>
            <p>Gulp is our build system that we use and trust. Find one that will work for you and your team and get started. With this presentation you learned the beginnings of how to put together a build system that will work for you.</p>
        </section>

        <section data-background="#f37021">
            <h2 style="color:#fff;">THANK YOU!</h2>

            <p style="color:#fff; padding-top:40px;">
                Chad Smith<br>
                Software Development Manager - Front-end<br>
                chad.smith@giftcards.com<br>
                @hppycoder<br>
                <img src="images/GKnockout.png" style="border:0; background:initial; box-shadow: none;">
            </p>
        </section>

    </div>

</div>

<footer>
    <p>
        <strong>Slides</strong> https://github.com/hppycoder/gulpNgPittsburgh<br>
        Chad Smith | @hppycoder | chad.smith@giftcards.com<br>
    </p>

</footer>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });

</script>

</body>
</html>